import{c as j,j as e,r as c}from"./index-C7lxWjak.js";const m="https://obake-uketuke-app-ae91e2b5463a.herokuapp.com/api",n=Date.now();function f(){const[t,u]=c.useState(""),[a,h]=c.useState(0),[l,b]=c.useState(0);return c.useEffect(()=>{const i=new URLSearchParams(window.location.search).get("ticket")||"";console.log("URL params:",window.location.search),console.log("Ticket from URL:",i),u(i);const d=async()=>{try{console.log("API呼び出し開始...");const s=await fetch(`${m}/reservations/status?t=${n}`,{method:"GET",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"omit",cache:"no-cache"});if(console.log("Status response:",s.status),s.ok){const o=await s.json();console.log("Status data:",o),h(o.data?.currentNumber||1)}else console.error("Status API error:",s.status,s.statusText);const r=await fetch(`${m}/reservations/counter?t=${n}`,{method:"GET",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"omit",cache:"no-cache"});if(console.log("Counter response:",r.status),r.ok){const o=await r.json();console.log("Counter data:",o),b(o.data?.counter||1)}else console.error("Counter API error:",r.status,r.statusText);console.log("API呼び出し完了")}catch(s){console.error("現在の番号取得エラー:",s)}};d();const N=setInterval(d,3e3);return()=>clearInterval(N)},[]),e.jsx("div",{className:"min-h-screen bg-[#fff6ef] flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8 max-w-md w-full text-center",children:[e.jsx("div",{className:"mx-auto h-16 w-16 rounded-full bg-emerald-100 text-emerald-600 flex items-center justify-center text-3xl mb-6",children:"✓"}),e.jsx("h1",{className:"text-2xl font-bold mb-4 text-gray-900",children:"整理券発行完了"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"整理券が正常に発行されました！"}),e.jsxs("div",{className:"mb-6",children:[t&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-sm text-gray-500 mb-2",children:"あなたの整理券番号"}),e.jsxs("div",{className:"text-5xl font-bold text-violet-600 mb-4",children:["#",t]})]}),e.jsxs("div",{className:"bg-yellow-100 border border-yellow-300 rounded p-2 mb-4",children:[e.jsxs("div",{className:"text-sm text-yellow-800 font-bold",children:["🔧 デバッグ情報 (Cache Bust: ",n,")"]}),e.jsxs("div",{className:"text-xs text-yellow-700",children:["ticketNo: ",t||"なし"," | currentNumber: ",a," | currentTicketNumber: ",l]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"現在の整理券番号"}),e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["#",l]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"現在の呼び出し番号"}),e.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:["#",a]})]})]}),t&&Number(t)-a>0&&e.jsxs("div",{className:"mt-3 text-sm text-gray-500",children:["あと約 ",e.jsx("span",{className:"font-bold text-violet-600",children:Number(t)-a})," 組お待ちください"]})]}),e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:e.jsx("p",{className:"text-red-700 text-sm font-medium",children:"この画面は受付で使用するため、スクリーンショットをお願いいたします。"})}),e.jsx("button",{onClick:()=>window.location.href="/reservation.html",className:"w-full bg-violet-600 hover:bg-violet-700 text-white py-3 rounded-xl font-medium transition-colors",children:"新しく整理券を発行する"})]})})}const x=document.getElementById("reservation-root");x&&j.createRoot(x).render(e.jsx(f,{}));
