import{r as t,j as e,A as L}from"./api.config-DsnaoXnZ.js";import{G as T,e as D,p as O}from"./api-BDIQQ6cc.js";function B({title:r,titleId:a,...o},l){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":a},o),r?t.createElement("title",{id:a},r):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"}))}const F=t.forwardRef(B);function G({title:r,titleId:a,...o},l){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":a},o),r?t.createElement("title",{id:a},r):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5"}))}const W=t.forwardRef(G);function V({title:r,titleId:a,...o},l){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":a},o),r?t.createElement("title",{id:a},r):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const Z=t.forwardRef(V);function _({title:r,titleId:a,...o},l){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":a},o),r?t.createElement("title",{id:a},r):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 6v.75m0 3v.75m0 3v.75m0 3V18m-9-5.25h5.25M7.5 15h3M3.375 5.25c-.621 0-1.125.504-1.125 1.125v3.026a2.999 2.999 0 0 1 0 5.198v3.026c0 .621.504 1.125 1.125 1.125h17.25c.621 0 1.125-.504 1.125-1.125v-3.026a2.999 2.999 0 0 1 0-5.198V6.375c0-.621-.504-1.125-1.125-1.125H3.375Z"}))}const q=t.forwardRef(_);function J(){const r=t.useMemo(()=>new Date().toLocaleString("ja-JP",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),[]),[a,o]=t.useState(""),[l,N]=t.useState(1),[h,w]=t.useState("ä¸€èˆ¬"),[f,b]=t.useState(!1),[j,v]=t.useState(null),[m,g]=t.useState(null),[p,k]=t.useState(""),[y,E]=t.useState(!1),[A,C]=t.useState(0),[S,R]=t.useState(0);t.useEffect(()=>{const s=async()=>{try{const n=await D();n.ok&&n.data&&E(n.data.systemPaused)}catch(n){console.error("ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ…‹å–å¾—ã‚¨ãƒ©ãƒ¼:",n)}};s();const i=setInterval(s,3e3);return()=>clearInterval(i)},[]),t.useEffect(()=>{if(!m)return;const s=async()=>{try{const n=L.baseURL.replace(/\/api$/,""),d=new Date().toISOString().split("T")[0],c=await fetch(`${n}/api/reservations/status?date=${d}&v=${Date.now()}`,{method:"GET",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"omit",cache:"no-store"});if(c.ok){const u=await c.json();C(u.data?.currentNumber||1)}const x=await fetch(`${n}/api/reservations/counter?date=${d}&v=${Date.now()}`,{method:"GET",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"omit",cache:"no-store"});if(x.ok){const u=await x.json();R(u.data?.counter||1)}}catch(n){console.error("ç¾åœ¨ã®ç•ªå·å–å¾—ã‚¨ãƒ©ãƒ¼:",n)}};s();const i=setInterval(s,3e3);return()=>clearInterval(i)},[m]);const P=s=>{o(s.target.value)},M=s=>{N(Number(s.target.value))},$=s=>{w(s.target.value)};async function I(s){s.preventDefault(),b(!0),v(null);try{const i=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent),n=/iPad|Android/i.test(navigator.userAgent)&&window.innerWidth>=768,d=i&&!n?"mobile":n?"tablet":"web";console.log(`ğŸ“¤ äºˆç´„é€ä¿¡: email=${a}, channel=${d}`);const c=await O({email:a,count:l,age:h,channel:d});if(!c.ok)throw console.error("APIé€ä¿¡ã‚¨ãƒ©ãƒ¼:",c),new Error(c.error||"æ•´ç†åˆ¸ã®ç™ºè¡Œã«å¤±æ•—ã—ã¾ã—ãŸ");console.log("âœ… æ•´ç†åˆ¸ç™ºè¡ŒæˆåŠŸ:",c.data);const x=c.data.ticketNo||c.data.id;g(x),k(c.data.createdAt||"")}catch(i){console.error("âŒ äºˆç´„ã‚¨ãƒ©ãƒ¼:",i),v(i?.message??"æ•´ç†åˆ¸ã®ç™ºè¡Œã«å¤±æ•—ã—ã¾ã—ãŸã€‚ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„ã€‚")}finally{b(!1)}}return m?e.jsx("div",{className:"min-h-screen bg-[#fff6ef] flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-lg bg-white/80 backdrop-blur rounded-2xl p-8 shadow-lg text-center",children:[e.jsx("div",{className:"mx-auto h-12 w-12 rounded-full bg-emerald-100 text-emerald-600 flex items-center justify-center text-2xl mb-4",children:"âœ“"}),e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"æ•´ç†åˆ¸ç™ºè¡Œå®Œäº†"}),e.jsx("p",{className:"text-slate-600 mb-6",children:"æ•´ç†åˆ¸ãŒæ­£å¸¸ã«ç™ºè¡Œã•ã‚Œã¾ã—ãŸï¼"}),e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"text-sm text-slate-500 mb-2",children:"ã‚ãªãŸã®æ•´ç†åˆ¸ç•ªå·"}),e.jsx("div",{className:"text-5xl font-bold text-violet-600",children:m}),p&&e.jsxs("div",{className:"mt-3 text-sm text-slate-600",children:["ç™»éŒ²æ™‚é–“: ",e.jsx("span",{className:"font-medium",children:p})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xs text-slate-500 mb-1",children:"ç¾åœ¨ã®æ•´ç†åˆ¸ç•ªå·"}),e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["#",S]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xs text-slate-500 mb-1",children:"ç¾åœ¨ã®å‘¼ã³å‡ºã—ç•ªå·"}),e.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:["#",A]})]})]}),e.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-4 text-amber-700 mb-6",children:[e.jsx("div",{className:"font-bold mb-2",children:"ã”æ¡ˆå†…"}),e.jsx("div",{className:"text-sm",children:"20çµ„å‰ã«ãªã£ãŸã‚‰å—ä»˜ä¼šå ´ã«ãŠè¶Šã—ãã ã•ã„ã€‚"})]}),e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 text-red-700 mb-6",children:[e.jsx("div",{className:"font-bold mb-2 text-center",children:"é‡è¦"}),e.jsx("div",{className:"text-sm text-center",children:"ã“ã®ç”»é¢ã¯å—ä»˜ã§ä½¿ç”¨ã™ã‚‹ãŸã‚ã€ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚¿ãƒ–ã¯å‰Šé™¤ã—ãªã„ã§ãã ã•ã„ã€‚ã¾ãŸå‘¼ã³å‡ºã—ç•ªå·ã¯ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§åæ˜ ã•ã‚Œã‚‹ãŸã‚ãƒªãƒ­ãƒ¼ãƒ‰ã¯è¡Œã‚ãªã„ã§ãã ã•ã„ã€‚"})]})]})}):e.jsxs("div",{className:"min-h-screen bg-[#fff6ef]",children:[e.jsx("header",{className:"sticky top-0 z-10 bg-white/70 backdrop-blur border-b",children:e.jsxs("div",{className:"mx-auto max-w-6xl px-4 h-14 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"inline-flex h-8 w-8 items-center justify-center rounded-lg bg-violet-600",children:e.jsx(T,{className:"h-6 w-6 text-white"})}),e.jsx("span",{className:"font-bold",children:"ãŠåŒ–ã‘å±‹æ•· æ•´ç†åˆ¸ã‚·ã‚¹ãƒ†ãƒ "})]}),e.jsx("nav",{className:"text-sm text-slate-600 flex items-center gap-6",children:e.jsx("a",{className:"font-semibold text-slate-900",href:"/reservation",children:"äºˆç´„ãƒ•ã‚©ãƒ¼ãƒ "})})]})}),y&&e.jsx("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4",children:e.jsx("div",{className:"mx-auto max-w-6xl px-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-4 h-4 bg-yellow-400 rounded-full"})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm text-yellow-700 font-medium",children:"ç¾åœ¨ç‚¹æ¤œä¸­ã®ãŸã‚ä¸€æ™‚ä¼‘æ­¢ä¸­ã§ã™ã€‚ã—ã°ã‚‰ããŠå¾…ã¡ãã ã•ã„ã€‚"})})]})})}),e.jsx("main",{className:"mx-auto max-w-3xl px-4 py-10",children:e.jsxs("form",{onSubmit:I,className:"mx-auto max-w-xl bg-white rounded-2xl shadow p-6 space-y-6",children:[e.jsxs("div",{className:"pb-3 border-b",children:[e.jsx("div",{className:"text-2xl font-bold text-center",children:"ãŠåŒ–ã‘å±‹æ•·æ•´ç†åˆ¸ãƒ•ã‚©ãƒ¼ãƒ "}),e.jsxs("div",{className:"mt-2 text-center text-slate-500 flex items-center justify-center gap-3 text-sm",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(W,{className:"w-4 h-4"})," ",r.split(" ")[0]]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Z,{className:"w-4 h-4"})," ",r.split(" ")[1]]})]})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-slate-600 text-sm",children:"ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹"}),e.jsx("input",{required:!0,type:"email",value:a,onChange:P,placeholder:"example@email.com",className:"mt-1 w-full rounded-lg border px-3 h-11"}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"â€» ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã¯æ•´ç†åˆ¸ç™ºè¡Œã®è¨˜éŒ²ã®ã¿ã«ä½¿ç”¨ã•ã‚Œã€å€‹äººæƒ…å ±ã¨ã—ã¦ä¿å­˜ã•ã‚Œã¾ã™ã€‚é€£çµ¡ã‚„é€šçŸ¥ã«ã¯ä½¿ç”¨ã•ã‚Œã¾ã›ã‚“ã€‚"})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-slate-600 text-sm",children:"äººæ•°"}),e.jsx("select",{className:"mt-1 w-full rounded-lg border h-11 px-3",value:l,onChange:M,children:[1,2,3,4,5,6,7,8].map(s=>e.jsxs("option",{value:s,children:[s,"å"]},s))})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-slate-600 text-sm",children:"å¹´é½¢å±¤"}),e.jsx("select",{className:"mt-1 w-full rounded-lg border h-11 px-3",value:h,onChange:$,children:["ä¸€èˆ¬","å¤§å­¦ç”Ÿ","é«˜æ ¡ç”Ÿä»¥ä¸‹"].map(s=>e.jsx("option",{value:s,children:s},s))})]}),j&&e.jsx("p",{className:"text-red-600 text-sm",children:j}),e.jsx("button",{disabled:f,className:"w-full h-12 rounded-xl font-bold text-white bg-gradient-to-r from-rose-500 to-violet-600 disabled:opacity-50",children:f?e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsx(F,{className:"w-5 h-5 animate-spin"}),"ç™ºè¡Œä¸­..."]}):e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsx(q,{className:"w-5 h-5"}),"æ•´ç†åˆ¸ã‚’ç™ºè¡Œã™ã‚‹"]})})]})})]})}export{J as R};
